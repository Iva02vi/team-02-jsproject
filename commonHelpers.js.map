{"version":3,"file":"commonHelpers.js","sources":["../src/js/favorites.js"],"sourcesContent":["import { openModalWindEx } from './modal-window-exercise';\n\nconst exercisesNotFound = document.querySelector(\n  '.favorites-page-items-not-found'\n);\nconst exercisesGallery = document.querySelector(\n  '.favorites-page-items-gallery'\n);\nconst favPageItems = document.querySelector(\".favorites-page-items\");\nconst mobilePagination = document.querySelector('.favorites-mobile-pagination');\n\nconst svgArrowUrl = new URL('/img/sprite.svg#icon-arrow', import.meta.url);\nconst KEY = 'favorites';\nconst storageFetch = localStorage.getItem(KEY);\nconst savedInStorageExercises = JSON.parse(storageFetch);\nconst svgLigthUrl = new URL('/img/sprite.svg#icon-lighticon', import.meta.url);\nconst svgTrashhUrl = new URL('/img/sprite.svg#icon-trash', import.meta.url);\n\nconst limitPerPage = 8;\nlet currentPage = 1;\nlet lastIdx = currentPage * limitPerPage;\nlet firstIdx = lastIdx - limitPerPage;\nlet markup = '';\nlet newStorageFetch;\nlet actualExercisesList;\nlet paginationButtons;\nlet totalPages = Math.ceil(savedInStorageExercises.length / limitPerPage);\n\nfunction hideElem(elem) {\n  elem.style.display = 'none';\n  if (elem === exercisesGallery && innerWidth > 768){\n    favPageItems.style.paddingRight = \"48px\";\n  }\n}\nfunction showElem(elem) {\n  elem.style.display = 'flex';\n  if (elem === exercisesGallery && innerWidth > 768){\n    favPageItems.style.paddingRight = \"0\";\n  }\n}\n\nif (window.innerWidth < 768) {\n  showElem(mobilePagination);\n}\nfunction renderExerciseCards(arr) {\n  exercisesGallery.innerHTML = '';\n  const galleryItems = arr.reduce(\n    (html, card) =>\n      html +\n      `<li class=\"gallery-list-item\">\n        <div class=\"workout-box\" id=${card._id}>\n          <div class=\"workout-header\">\n              <div class=\"workout-header-wrap\">\n                  <span class=\"workout-title\">WORKOUT</span>\n                  <button type=\"button\" class=\"delete-workout-btn\" id=\"${card._id}\">                            \n                      <svg class=\"trash-icon\" id=\"${card._id}\" width=\"16\" height=\"16\" aria-label=\"trash-icon\">\n                        <use href=${svgTrashhUrl} id=\"${card._id}\"></use>\n                      </svg>\n                  </button>\n              </div>\n              <div class=\"start-button-wrap\">Start\n                  <svg class=\"start-arrow-icon\" id=${card._id} width=\"14\" height=\"14\" aria-label=\"start-arrow\">\n                    <use href=${svgArrowUrl}></use>\n                  </svg>\n              </div>\n          </div>\n          <div class=\"workout-type\">\n              <svg class=\"run-man-icon\" width=\"24\" height=\"24\" aria-label=\"run-man\">\n                  <use href=\"${svgLigthUrl}\"></use>\n              </svg>\n              <h3 class=\"workout-name\">${card.name}</h3>\n          </div>\n          <div class=\"workout-description\">\n              <p class=\"description-item-name\">Burned calories:\n                  <span class=\"description-item-value\">${card.burnedCalories} / ${card.time} min</span>\n              </p>\n              <p class=\"description-item-name\">Body part:\n                  <span class=\"description-item-value\">${card.bodyPart}</span>\n              </p>\n              <p class=\"description-item-name\">Target:\n                  <span class=\"description-item-value\">${card.target}</span>\n              </p>\n          </div>\n        </div>\n      </li>`,\n    ''\n  );\n  exercisesGallery.innerHTML = galleryItems;\n}\n\nif (storageFetch === null || savedInStorageExercises.length === 0) {\n  hideElem(exercisesGallery);\n} else {\n  hideElem(exercisesNotFound);\n  renderExerciseCards(savedInStorageExercises);\n}\n\nexercisesGallery.addEventListener('click', async event => {\n  let id;\n  const clickedButton = event.target;\n  if (clickedButton.className !== 'delete-workout-btn') {\n    if (clickedButton && clickedButton.closest('.workout-box')) {\n      id = clickedButton.closest('.workout-box').getAttribute('id');\n      await openModalWindEx(id);\n    }\n  }\n});\n\nif (window.innerWidth < 768) {\n  markup = '';\n  mobilePagination.innerHTML = '';\n  for (let i = 1; i <= totalPages; i++) {\n    if (i === 1) {\n      markup += `\n        <li>\n          <button class=\"favorites-pagination-button fav-active-page\" type=\"button\" id=\"${i}\">${i}</button>\n        </li>`;\n    } else {\n      markup += `\n        <li>\n          <button class=\"favorites-pagination-button\" type=\"button\" id=\"${i}\">${i}</button>\n        </li>`;\n    }\n  }\n  mobilePagination.innerHTML = markup;\n\n  renderExerciseCards(savedInStorageExercises.slice(firstIdx, lastIdx));\n\n  mobilePagination.addEventListener('click', event => {\n    event.preventDefault();\n    if (event.target.classList.value.includes('favorites-pagination-button')) {\n      currentPage = event.target.id;\n      lastIdx = currentPage * limitPerPage;\n      firstIdx = lastIdx - limitPerPage;\n      newStorageFetch = localStorage.getItem(KEY);\n      actualExercisesList = JSON.parse(newStorageFetch);\n      renderExerciseCards(actualExercisesList.slice(firstIdx, lastIdx));\n\n      const clickedButton = event.target.closest(\n        '.favorites-pagination-button'\n      );\n      paginationButtons = document.querySelectorAll(\n        '.favorites-pagination-button'\n      );\n      paginationButtons.forEach(button => {\n        if (button.id === clickedButton.id) {\n          button.classList.add('fav-active-page');\n        } else {\n          button.classList.remove('fav-active-page');\n        }\n      });\n      window.scrollBy({\n        top: 700,\n        behavior: 'smooth',\n      });\n    }\n  });\n}\n\nexercisesGallery.addEventListener('click', event => {\n  event.preventDefault();\n  if (event.target.className === 'delete-workout-btn') {\n    newStorageFetch = localStorage.getItem(KEY);\n    actualExercisesList = JSON.parse(newStorageFetch);\n    const filteredArr = actualExercisesList.filter(\n      card => card._id !== event.target.id\n    );\n    localStorage.setItem(KEY, JSON.stringify(filteredArr));\n\n    if (filteredArr.length === 0) {\n      hideElem(exercisesGallery);\n      showElem(exercisesNotFound);\n      window.scrollBy({\n        top: 700,\n        behavior: 'smooth',\n      });\n      if (window.innerWidth < 768) {\n        hideElem(mobilePagination);\n      }\n    } else {\n      if (window.innerWidth < 768) {\n        totalPages = Math.ceil(filteredArr.length / limitPerPage);\n        markup = '';\n        for (let i = 1; i <= totalPages; i++) {\n          if (i === Number(currentPage)) {\n            markup += `\n              <li>\n                <button class=\"favorites-pagination-button fav-active-page\" type=\"button\" id=\"${i}\">${i}</button>\n              </li>`;\n          } else {\n            markup += `\n              <li>\n                <button class=\"favorites-pagination-button\" type=\"button\" id=\"${i}\">${i}</button>\n              </li>`;\n          }\n        }\n        mobilePagination.innerHTML = markup;\n        lastIdx = currentPage * limitPerPage;\n        firstIdx = lastIdx - limitPerPage;\n        renderExerciseCards(filteredArr.slice(firstIdx, lastIdx));\n        window.scrollBy({\n          top: 700,\n          behavior: 'smooth',\n        });\n      } else {\n        renderExerciseCards(filteredArr);\n      }\n    }\n  }\n});\n\nexport const renderFavorites = () => {\n  savedInStorageExercises = JSON.parse(localStorage.getItem(KEY)) || {};\n  if (!savedInStorageExercises || savedInStorageExercises.length === 0) {\n    hideElem(exercisesGallery);\n  } else {\n    hideElem(exercisesNotFound);\n    renderExerciseCards(savedInStorageExercises);\n  }\n  totalPages = Math.ceil(savedInStorageExercises.length / 3);\n};\n"],"names":["exercisesNotFound","exercisesGallery","favPageItems","mobilePagination","svgArrowUrl","KEY","storageFetch","savedInStorageExercises","svgLigthUrl","svgTrashhUrl","limitPerPage","currentPage","lastIdx","firstIdx","markup","newStorageFetch","actualExercisesList","paginationButtons","totalPages","hideElem","elem","showElem","renderExerciseCards","arr","galleryItems","html","card","event","id","clickedButton","openModalWindEx","i","button","filteredArr"],"mappings":"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"}